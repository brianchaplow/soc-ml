# =============================================================================
# SOC-ML OpenSearch Configuration
# Author: Brian Chaplow (Chappy McNasty)
# =============================================================================

connection:
  host: ${OPENSEARCH_HOST:10.10.20.10}
  port: ${OPENSEARCH_PORT:9200}
  user: ${OPENSEARCH_USER:admin}
  password: ${OPENSEARCH_PASS}
  use_ssl: true
  verify_certs: false
  ssl_show_warn: false
  timeout: 60

indices:
  # Suricata alerts (new dedicated index, was fluentbit-default)
  alerts: "suricata"

  # Zeek conn.log (new dedicated index, was fluentbit-default)
  zeek: "zeek"

  # Legacy index (pre-2026-02-06 data)
  legacy: "fluentbit-default"

  # Web application logs (enriched)
  apache: "apache-parsed-v2"

  # Windows endpoint telemetry
  windows: "winlog-*"

  # Honeypot data
  honeypot: "honeypot-credentials"

# Query settings
query:
  # Maximum records per scroll batch
  scroll_size: 10000
  
  # Scroll context timeout
  scroll_timeout: "5m"
  
  # Maximum total records to pull (safety limit)
  max_records: 1000000

# Date range for training data
date_range:
  # Use temporal split: train on earlier data, test on later
  train_start: "2025-12-03"
  train_end: "2026-01-27"
  test_start: "2026-01-28"
  test_end: "2026-02-28"

# Zeek conn.log enrichment settings
zeek:
  enabled: true
  correlation:
    time_tolerance: 10.0      # seconds for 5-tuple join (Zeek @timestamp has ~6s ingestion delay)
    max_records_multiplier: 5  # pull 5x Suricata records of Zeek data
  conn_fields:
    - "@timestamp"
    - "uid"
    - "id.orig_h"
    - "id.orig_p"
    - "id.resp_h"
    - "id.resp_p"
    - "proto"
    - "duration"
    - "conn_state"
    - "history"
    - "service"
    - "local_orig"
    - "local_resp"
    - "orig_bytes"
    - "resp_bytes"
    - "orig_pkts"
    - "resp_pkts"
    - "orig_ip_bytes"
    - "resp_ip_bytes"
    - "missed_bytes"
